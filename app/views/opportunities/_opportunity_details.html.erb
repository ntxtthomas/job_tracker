<div id="<%= dom_id opportunity %>">
  <h2><%= opportunity.position_title %></h2>

  <div class="opportunity-details">
    <p>
      <strong>Company:</strong>
      <%= link_to opportunity.company.name, opportunity.company if opportunity.company %>
    </p>

    <% if opportunity.company&.website.present? %>
    <p>
      <strong>Website:</strong>
      <%= link_to opportunity.company.website, opportunity.company.website, target: "_blank", rel: "noopener noreferrer" %>
    </p>
    <% end %>

    <% if opportunity.company&.linkedin.present? %>
    <p>
      <strong>LinkedIn:</strong>
      <%= link_to opportunity.company.linkedin, opportunity.company.linkedin, target: "_blank", rel: "noopener noreferrer" %>
    </p>
    <% end %>

    <p>
      <strong>Application Date:</strong>
      <%= opportunity.application_date %>
    </p>

    <p>
      <strong>Status:</strong>
      <span class="status-<%= opportunity.status %>"><%= opportunity.status&.humanize %></span>
    </p>

    <p>
      <strong>Remote:</strong>
      <%= opportunity.remote ? "Yes" : "No" %>
    </p>

    <% if opportunity.technologies.any? %>
    <p>
      <strong>Technologies:</strong>
      <div style="margin-top: 5px;">
        <% Technology::CATEGORIES.each do |category| %>
          <% category_techs = opportunity.technologies.where(category: category).order(:name) %>
          <% next if category_techs.empty? %>
          <div style="margin-bottom: 10px;">
            <strong style="font-size: 14px; color: var(--text-secondary, #666);"><%= category %>:</strong>
            <div style="display: flex; flex-wrap: wrap; gap: 5px; margin-top: 3px;">
              <% category_techs.each do |tech| %>
                <span style="background-color: #e7f1ff; color: #0056b3; padding: 3px 8px; border-radius: 3px; font-size: 13px;"><%= tech.name %></span>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    </p>
    <% end %>
    
    <% if opportunity.other_tech_stack.present? %>
    <p>
      <strong>Other Technologies:</strong>
      <%= opportunity.other_tech_stack %>
    </p>
    <% end %>

    <% if opportunity.source.present? %>
    <p>
      <strong>Source:</strong>
      <%= opportunity.source&.humanize %>
    </p>
    <% end %>

    <% if opportunity.salary_range.present? %>
    <p>
      <strong>Salary Range:</strong>
      <%= opportunity.salary_range %>
    </p>
    <% end %>

    <% if opportunity.listing_url.present? %>
    <p>
      <strong>Listing URL:</strong>
      <%= link_to opportunity.listing_url, opportunity.listing_url, target: "_blank", rel: "noopener noreferrer" %>
    </p>
    <% end %>

    <% if opportunity.chatgpt_match.present? %>
    <p>
      <strong>ChatGPT Match:</strong>
      <%= opportunity.chatgpt_match %>
    </p>
    <% end %>

    <% if opportunity.jobright_match.present? %>
    <p>
      <strong>Jobright Match:</strong>
      <%= opportunity.jobright_match %>
    </p>
    <% end %>

    <% if opportunity.linkedin_match.present? %>
    <p>
      <strong>LinkedIn Match:</strong>
      <%= opportunity.linkedin_match %>
    </p>
    <% end %>

    <% if opportunity.notes.present? %>
    <p>
      <strong>Notes:</strong>
    </p>
    <div class="notes">
      <%= simple_format(opportunity.notes) %>
    </div>
    <% end %>
  </div>
</div>
